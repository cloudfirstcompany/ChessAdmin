{% extends 'base.html' %}
{% load staticfiles %}
{% load widget_tweaks %}
{% load guardian_tags %}

{% load staticfiles %}

{% block body_block %}

{% get_obj_perms request.user for club as "club_perms" %}
<section class='section'>
<div class='container'>
{% include 'club_bar.html' with club_id=club.id user=request.user%}

<h1> {{ club.club_name }} Roster </h1>
<table class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Title</th>
      {% if "can_handle_promotion_requests" in club_perms %}
        <th>Modify Role</th>
      {% endif %}
    </tr>
  </thead>
  <tfoot>
    <tr>
      <th>Name</th>
      <th>Title</th>
      {% if "can_handle_promotion_requests" in club_perms %}
        <th>Modify Role</th>
      {% endif %}
    </tr>
  </tfoot>
  <tbody>
  {% for member in members %}
    <tr>
      <td>{{ member.user.first_name}} {{ member.user.last_name }}</td>
      <td>{{ member.group }}</td>
      {% if "can_remove_member" in club_perms or "can_handle_promotion_requests" in club_perms %}
      <div class="block">
      {% if "can_remove_member" in club_perms %}
      <form method='POST' action="{% url 'suite:club_roster' club.id %}">
        {% csrf_token %}
        <td><input class='button is-danger' type='submit' name='submit' value='Delete {{ member.user.first_name }}'>
        <input type='hidden' name='delete' value='{{ member.user.id }}'>
      </form>
      {% endif %}
      {% if "can_handle_promotion_requests" in club_perms %}
      <form method='POST' action="{% url 'suite:club_roster' club.id %}">
        {% csrf_token %}
        <input class='button is-success' type='submit' name='submit' value='Promote {{ member.user.first_name }}'>
        <input type='hidden' name='promote' value='{{ member.user.id }}'>
      </form>
      {% endif %}
      {% if "can_handle_promotion_requests" in club_perms %}
      <form method='POST' action="{% url 'suite:club_roster' club.id %}">
        {% csrf_token %}
        <input class='button is-warning' type='submit' name='submit' value='Demote {{ member.user.first_name }}'></td>
        <input type='hidden' name='demote' value='{{ member.user.id }}'>
      </form>
      {% endif %}
      </div>
      {% endif %}
    </tr>
    {% endfor %}
  </tbody>
</table>
    
  </ul>
  </div>
</section>

{% endblock body_block %}
